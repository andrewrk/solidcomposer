<% if (json.user.is_authenticated) { %>
    <div id="bands">
        <h1>Your Bands</h1>
        <a class="create-band" href="{% url workbench.create_band %}">Create a New Band</a>
        <ul>
            <% $.each(json.members, function(i, member){ var band = member.band; %>
                <li class="band">
                    <a href="<%=urls.band(band.id)%>"><%=band.title%></a>
                </li>
            <% }); %>
            <% $.each(json.invites, function(i, item){ %>
                <li class="invite">
                    <span class="label">invitation</span>
                    <a href="<%=urls.band(item.band.id)%>"><%=item.band.title%></a>
                    <span class="role"><%=roleNames[item.role]%></span>
                    <span class="action">
                    <a href="#" class="accept" data-index="<%=i%>">accept</a>
                    <a href="#" class="ignore" data-index="<%=i%>">ignore</a>
                    </span>
                </li>
            <% }); %>
        </ul>
    </div>
    <div id="activity">
        <h1>Recent Activity</h1>
            <% if (logEntries.length > 0) { %>
                <ul>
                    <% for (var i=logEntries.length-1; i>=0; --i) { var entry = logEntries[i]; %>
                        <li>
                            <% if (entry.entry_type === entryTypeEnum.SONG_CRITIQUE) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%=entry.catalyst.username%></a>
                                added
                                <a href="<%= urls.project_version(entry.version.project.id, entry.band, entry.version.version) %>">a comment</a>
                                to
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.version.project.title %></a>.
                            <% } else if (entry.entry_type === entryTypeEnum.SONG_CHECKED_IN) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                checked in a
                                <a href="<%= urls.project_version(entry.version.project.id, entry.band, entry.version.version) %>">new version</a>
                                of
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.version.project.title %></a>.
                            <% } else if (entry.entry_type === entryTypeEnum.SONG_CHECKED_OUT) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                checked out
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.version.project.title %></a>.
                            <% } else if (entry.entry_type === entryTypeEnum.SAMPLES_UPLOADED) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                <a href="<%= urls.project_version(entry.version.project.id, entry.band, entry.version.version) %>">uploaded samples</a>
                                to
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.version.project.title %></a>.
                            <% } else if (entry.entry_type === entryTypeEnum.SONG_RENAMED) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                renamed
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.old_title %></a>
                                to
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.version.project.title %></a>.
                            <% } else if (entry.entry_type === entryTypeEnum.POKE) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                wants
                                <% if (entry.target.id === json.user.id) { %>
                                    <strong>you</strong>
                                    to hurry up and
                                    <a href="<%= urls.project(entry.version.project.id, entry.band) %>">check in</a>.
                                <% } else { %>
                                    <a href="<%= urls.userpage(entry.target.username) %>"><%= entry.target.username %></a>
                                    to hurry up and check in
                                <% } %>
                                <a href="<%= urls.project(entry.version.project.id, entry.band) %>"><%= entry.version.project.title %></a>.
                            <% } else if (entry.entry_type === entryTypeEnum.BAND_MEMBER_JOIN) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                has joined the band.
                            <% } else if (entry.entry_type === entryTypeEnum.BAND_MEMBER_QUIT) { %>
                                <a href="<%= urls.userpage(entry.catalyst.username) %>"><%= entry.catalyst.username %></a>
                                has quit the band.
                            <% } %>
                        </li>
                    <% } %>
                </ul>
            <% } else { %>
                <p>No recent activity to report.</p>
            <% } %>
    </div>
<% } else { %>
    <p>
        <strong>Workbench</strong> is a project manager, providing version control
        and backups of your work. It makes collaboration with other people
        a piece of cake.
    </p>
    <p>
        <a id="workbenchSignIn" href="{% url user_login %}">Sign in</a> or
        <a href="{% url register %}">register</a> to participate.
    </p>
<% } %>
